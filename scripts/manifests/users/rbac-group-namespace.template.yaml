---
# Namespace for Group (if needed)
# Template variables: NAMESPACE
apiVersion: v1
kind: Namespace
metadata:
  name: ${NAMESPACE}
  labels:
    name: ${NAMESPACE}
    rbac.openportal.dev/managed-by: rbac-create-group

---
# RoleBinding for OIDC Group in Namespace
# Template variables: GROUP_NAME, BINDING_NAME, NAMESPACE, ROLE, CREATED_AT, DESCRIPTION
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: ${BINDING_NAME}
  namespace: ${NAMESPACE}
  labels:
    rbac.openportal.dev/type: group-namespace-access
    rbac.openportal.dev/managed-by: rbac-create-group
    rbac.openportal.dev/group: "${GROUP_NAME}"
  annotations:
    rbac.openportal.dev/description: "${DESCRIPTION}"
    rbac.openportal.dev/created-at: "${CREATED_AT}"
    rbac.openportal.dev/group-name: "${GROUP_NAME}"
subjects:
- kind: Group
  name: "oidc:${GROUP_NAME}"
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: ${ROLE}
  apiGroup: rbac.authorization.k8s.io
