apiVersion: kubernetes.crossplane.io/v1alpha2
kind: Object
metadata:
  name: postgres-secret
  namespace: default
spec:
  forProvider:
    manifest:
      apiVersion: v1
      kind: Secret
      metadata:
        name: postgres-credentials
        namespace: backstage
      type: Opaque
      data:
        # These are base64 encoded placeholder values
        # IMPORTANT: Replace with actual values or use external secret management
        # Example: POSTGRES_USER: <base64-encoded-username>
        POSTGRES_USER: PFlPVVJfVVNFUl9IRVJFPQ== # <YOUR_USER_HERE>
        POSTGRES_PASSWORD: PFlPVVJfUEFTU1dPUkRfSEVSRT4= # <YOUR_PASSWORD_HERE>
        POSTGRES_DB: PFlPVVJfREJfSEVSRT4= # <YOUR_DB_HERE>
  providerConfigRef:
    name: kubernetes-provider
  references:
    # This ensures the namespace exists before creating the secret
    - patchesFrom:
        apiVersion: kubernetes.crossplane.io/v1alpha2
        kind: Object
        name: backstage-namespace
        namespace: default
        fieldPath: metadata.uid
      toFieldPath: metadata.annotations[crossplane.io/dependency]